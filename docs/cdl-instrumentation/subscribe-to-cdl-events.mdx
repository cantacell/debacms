---
sidebar_label: Subscribe To Events
sidebar_position: 6
id: Subscribe To Events
toc_min_heading_level: 2
toc_max_heading_level: 4
---

## Subscribe to Common Data Layer Events

Common Data Layer allows teams to subscribe to pushes sent into it. This allows connecting its data to other analytics tools.

The subscribe method is used to register a callback function that will be called for each push.
Every time the Data Layer state is updated then the subscribers will be notified with a copy of its state, original data pushed
and additional information.
The notifies are sent only when all [required fields](./getting-started.mdx#setup-page-level-data) are set and the `dataLayerReady` property is `true`.

Additional information object structure:

| Field name | Data type(s) | Example | Description                                                                                                                                                                                                       |
| ---------- | ------------ | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| isEvent    | boolean      | true    | Indicates if data pushed to CDL is event or not. Data considered to be event if both `action` and `element` fields of `eventProperties` object are set. Only events can be propagated to Pixall server. |

Example:

Initial state:

```js
{
  'application': {
    'componentId': '123456'
  }
}
```

Subscribing to the data layer:

```js
// function is called on each data layer update containing the state of the datalayer, original data pushed and additional information object.
coxAutoDataLayer.subscribe(function (state, data, additionalInfo) {
  console.log("current state:", state);
  console.log("original data:", data);
  console.log("additional information:", additionalInfo);
  myDataLayer.push(state, event);
});
```

Making another data layer push:

```js
coxAutoDataLayer.push({
  vehicle: {
    make: 'Audi'
  }
});
```

Then the output will be showed into the console

```js
current state:  {
                  'application': {
                    'componentId': '123456'
                  },
                  vehicle: {
                    make: 'Audi'
                  }
                }

original data: {
                  vehicle: {
                    make: 'Audi'
                  }
                }
additional information: {
                  isEvent: false,
                }
```

:::info
Subscribers will receive notifications only if:

- `dataLayerReady` field is `true` [Signal Page is Ready](./signale-page-ready.mdx)
- required fields are set (Appropriate link will be provided in the future)
:::

### Receive past events

By default, when subscribing, you will receive immediately all pushes already processed by cdl.

If you don't want to receive them, then set the property `pastPushes` as `false`:

```js title='Example:'
coxAutoDataLayer.subscribe(function (state, data, additionalInfo) {
  ...
  },
   {
    pastPushes: false
   }
);
```
